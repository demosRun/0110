<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <!-- 页面的元信息 -->
  <title>{TAG_14226_TAG}</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />
  <meta name="format-detection" content="telephone=no, email=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="white" />
  <meta name="renderer" content="webkit" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="filetype" content="1" />
  <meta name="publishedtype" content="1" />
  <meta name="pagetype" content="2" />
  <meta name="screen-orientation" content="landscape" />
  <meta name="x5-orientation" content="landscape" />
  <meta name="full-screen" content="yes" />
  <meta name="x5-fullscreen" content="true" />
  <meta name="browsermode" content="application" />
  <meta name="x5-page-mode" content="app" />

  <!-- 页面主样式文件 -->
  <link charset="utf-8" rel="stylesheet" href="./static/css/owo.core.css">

  <!-- 附属css文件 -->
  <link rel="stylesheet" href="./static/css/main.css" charset="utf-8">

</head>

<body>
  <div class="scale-box">
    <!-- 页面[loading]-->
    <div class="loading-box page" template="loading" style="display: none;">
      <div class="loading-bar">
        <div class="num-bar"></div>
      </div>
      <div class="num">0%</div>
    </div>
    <!-- 页面[page1]-->
    <div class="page-1 page" template="page1" style="display: none;">
      <div class="text-box">
        <img src="./static/resource/text.png">
      </div>
      <img class="tiaoguo" src="./static/resource/tiaoguo.png" go="page2//moveToTop/moveFromBottom/true/moveToBottom/moveFromTop">
    </div>
    <!-- 页面[page2]-->
    <div class="page-2 page" template="page2" style="display: none;">
      <img class="so so-0" src="./static/resource/1305.png">
      <img class="so so-1" src="./static/resource/410.png">
      <img class="so so-2" src="./static/resource/1573.png">
      <img class="so so-4" src="./static/resource/1572.png">
      <img class="doit elementToAnimate" src="./static/resource/doit.png">
    </div>
    <!-- 页面[page3]-->
    <div class="page3 page" template="page3" style="display: none;">
      <div class="so so-0">
        <select class="select" name="" id="city" o-value="this.data.city">
          <option value="" disabled="disabled">我在这里</option>
          <option value="北京">北京</option>
          <option value="天津">天津</option>
          <option value="河北">河北</option>
          <option value="山西">山西</option>
          <option value="内蒙古">内蒙古</option>
          <option value="辽宁">辽宁</option>
          <option value="吉林">吉林</option>
          <option value="黑龙江">黑龙江</option>
          <option value="上海">上海</option>
          <option value="江苏">江苏</option>
          <option value="浙江">浙江</option>
          <option value="安徽">安徽</option>
          <option value="福建">福建</option>
          <option value="江西">江西</option>
          <option value="山东">山东</option>
          <option value="河南">河南</option>
          <option value="湖北">湖北</option>
          <option value="湖南">湖南</option>
          <option value="广东">广东</option>
          <option value="广西">广西</option>
          <option value="海南">海南</option>
          <option value="重庆">重庆</option>
          <option value="四川">四川</option>
          <option value="贵州">贵州</option>
          <option value="云南">云南</option>
          <option value="陕西">陕西</option>
          <option value="甘肃">甘肃</option>
          <option value="青海">青海</option>
          <option value="宁夏">宁夏</option>
          <option value="新疆">新疆</option>
          <option value="香港">香港</option>
          <option value="澳门">澳门</option>
          <option value="台湾">台湾</option>
        </select>
      </div>
      <div class="so so-1">
        <select class="select" name="" id="toType" o-value="this.data.toType">
          <option value="" disabled="disabled">我要表白</option>
          <option value="4">我是警察节见证者，我要表白</option>
          <option value="2">我的家人是警察，我要表白</option>
          <option value="1">我的爱人是警察，我要表白</option>
          <option value="3">我的朋友是警察，我要表白</option>
        </select>
      </div>
      <img class="so so-3" src="./static/resource/945.png" o-tap="next">
      <img class="so so-4" src="./static/resource/947.png" o-animation="shrink">
    </div>
    <!-- 页面[page4]-->
    <div class="page4 page" template="page4" style="display: none;">
      <img class="so so-0" src="./static/resource/1660.png">
      <img class="so so-1" src="./static/resource/1661.png">
      <img class="so so-2" src="./static/resource/1664.png" go="page3//moveToBottom/moveFromTop//TopmoveToTop/moveFromBottom">
      <img class="so so-3" src="./static/resource/1663.png" go="page5//moveToTop/moveFromBottom//moveToBottom/moveFromTop">
      <img class="so so-5" src="./static/resource/1662.jpg">
      <img class="so bi" src="./static/resource/bi.png" o-animation="floatUpDownSmall">
      <img class="text">
      <div class="date"></div>
      <div class="date1"></div>
    </div>
    <!-- 页面[page5]-->
    <div class="page5 page" template="page5" style="display: none;"><canvas id="canvas" width="750" height="1508"></canvas>
      <img class="show">
      <img class="so so-4" src="./static/resource/901.png" o-animation="flicker">
    </div>
  </div>

  <!-- 框架script文件 -->
  <script src="./static/js/owo.core.js" type="text/javascript" charset="UTF-8"></script>
  <script type="text/javascript" charset="UTF-8">
    owo.script = {
      "loading": {
        "data": {
          "imgList": ["./static/resource/1662.jpg", "./static/resource/bg.png", "./static/resource/bg-1.jpg", "./static/resource/bg-1.png", "./static/resource/bg-2.png", "./static/resource/bg-3.png", "./static/resource/loading.png", "./static/resource/1572.png", "./static/resource/410.png", "./static/resource/text.png", "./static/resource/bianqian.png", "./static/resource/1305.png", "./static/resource/945.png", "./static/resource/947.png", "./static/resource/1573.png", "./static/resource/e5bec99dd25ce1cc2c39be0581dd706.png", "./static/resource/tiaoguo.png", "./static/resource/307.jpg"]
        },
        "show": function show() {
          var mum = owo.query('.num')[0];
          var numBar = owo.query('.num-bar')[0];
          this.preloadImages(this.data.imgList, function(e) {
            setTimeout(function() {
              owo.go('page1////true');
            }, 1500);
          }, function(num) {
            numBar.style.width = num + '%';
            mum.innerHTML = num + '%';
          });
        },
        "preloadImage": function preloadImage(src, successFn) {
          var image = new Image();
          image.src = src;

          image.onload = function() {
            successFn && successFn(src);
          };

          image.onerror = function(error) {
            successFn && successFn(src);
          };
        },
        "preloadImages": function preloadImages(srcs, doneFn, progressFn) {
          var _this = this;

          if (!Array.isArray(srcs)) {
            console.log('第一个参数只能是一个数组');
          } else {
            var allCount = srcs.length;
            var doneCount = 0;
            srcs.forEach(function(srcItem) {
              _this.preloadImage(srcItem, function() {
                doneCount++;
                progressFn && progressFn(Math.ceil(100 * doneCount / allCount));

                if (doneCount === allCount) {
                  doneFn && doneFn();
                }
              });
            });
          }
        }
      },
      "page1": {
        "created": function created() {
          var _this2 = this;

          setTimeout(function() {
            _this2.query('.text-box img').style.top = '-40%';
          }, 100);
          setTimeout(function() {
            if (owo.activePage == 'page1') {
              owo.go('page2//moveToTop/moveFromBottom/true/moveToBottom/moveFromTop');
            }
          }, 12000);
        }
      },
      "page2": {
        "created": function created() {
          owo.tool.touch({
            el: this.$el,
            end: function end(e) {
              if (e.swipe[1] < -100) {
                owo.go('page3//moveToTop/moveFromBottom//moveToBottom/moveFromTop');
              } else if (e.swipe[1] > 100) {
                owo.go('page1//moveToBottom/moveFromTop//moveToTop/moveFromBottom');
              }
            }
          });
          owo.animate('zoomIn', this.query('.so-1'), 1000);
        }
      },
      "page3": {
        "data": {
          "city": "",
          "toType": ""
        },
        "show": function show() {
          var _this3 = this;

          this.data.city = '';
          this.data.toType = '';
          this.query('#toType')[0].selected = true;
          this.query('#city')[0].selected = true;
          setTimeout(function() {
            _this3.handleEvent();
          }, 100);
        },
        "created": function created() {
          var _this4 = this;

          owo.tool.touch({
            el: this.$el,
            end: function end(e) {
              if (e.swipe[1] < -100) {
                _this4.next();
              } else if (e.swipe[1] > 100) {
                owo.go('page2//moveToBottom/moveFromTop//moveToTop/moveFromBottom');
              }
            }
          });
        },
        "next": function next() {
          if (this.data.city && this.data.toType) {
            owo.go('page4//moveToTop/moveFromBottom//moveToBottom/moveFromTop');
          } else {
            owo.tool.toast('请先选择位置及表白对象哦!');
          }
        }
      },
      "page4": {
        "show": function show() {
          var bgURL = './static/resource/bg-2.png';
          var textURL = './static/resource/text-3.png';
          var leftP = '223';
          console.log(textURL);
          var date = new Date();
          var month = date.getMonth() + 1;
          var day = date.getDate();
          var dataStr = date.getFullYear() + "." + (month < 10 ? '0' + month : month) + "." + (day < 10 ? '0' + day : day);
          if (!owo.script.page3.data.city) owo.script.page3.data.city = '北京';
          var showSign = dataStr + '于' + owo.script.page3.data.city;
          this.query('.date').innerText = owo.script.page3.data.city;
          this.query('.date1').innerText = dataStr;

          switch (owo.script.page3.data.toType) {
            case '1':
              bgURL = './static/resource/1662.jpg';
              textURL = './static/resource/text-4.png';
              leftP = '181';
              break;

            case '2':
              leftP = '208';
              bgURL = './static/resource/bg-3.png';
              textURL = './static/resource/text-1.png';
              break;

            case '3':
              bgURL = './static/resource/bg-1.png';
              textURL = './static/resource/text-2.png';
              break;

            case '4':
              bgURL = './static/resource/bg-2.png';
              textURL = './static/resource/text-3.png';
              leftP = '210';
              break;
          }

          this.query('.so-5').src = bgURL;
          this.query('.text').src = textURL;
          this.query('.text').style.left = leftP + 'px';
          setTimeout(function() {
            // 绘制canvas
            var canvas = oCanvas.create({
              canvas: "#canvas"
            });
            canvas.addChild(canvas.display.image({
              x: 0,
              y: 0,
              width: 750,
              height: 1508,
              // origin: { x: "center", y: "center" },
              image: bgURL
            }));
            canvas.addChild(canvas.display.image({
              x: 43,
              y: 210,
              width: 678,
              height: 972,
              // origin: { x: "center", y: "center" },
              image: "./static/resource/share.png"
            }));
            canvas.addChild(canvas.display.image({
              x: leftP,
              y: 542,
              // origin: { x: "center", y: "center" },
              image: textURL
            }));
            canvas.addChild(canvas.display.text({
              x: 382,
              y: 824,
              width: 200,
              font: "bold 38px sans-serif",
              size: 30,
              // origin: { x: "center", y: "top" },
              text: owo.script.page3.data.city,
              fill: "#616160"
            }));
            canvas.addChild(canvas.display.text({
              x: 475,
              y: 835,
              width: 200,
              font: "bold 38px sans-serif",
              size: 18,
              // origin: { x: "center", y: "top" },
              text: dataStr,
              fill: "#616160"
            }));
            setTimeout(function() {
              document.querySelector('.show').src = canvas.canvasElement.toDataURL("image/png");
            }, 500);
          }, 1000);
        }
      },
      "page5": {}
    };
  </script>

  <script src="http://tools.people.com.cn/libs/jquery/1.11.1/jquery-1.11.1.min.js" type="text/javascript" charset="UTF-8"></script>
  <script src="./static/js/main.js" type="text/javascript" charset="UTF-8"></script>
  <script src="./static/js/autoScale.js" type="text/javascript" charset="UTF-8"></script>
  <script src="./static/js/touch.js" type="text/javascript" charset="UTF-8"></script>
  <script src="./static/js/ocanvas-2.10.0.min.js" type="text/javascript" charset="UTF-8"></script>

  <script src="./static/js/toast.js" type="text/javascript" charset="UTF-8"></script>
</body>

</html>